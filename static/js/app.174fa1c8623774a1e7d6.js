webpackJsonp([1],{"2N0H":function(e,t){},"2RMo":function(e,t){},"57qT":function(e,t){},"6w8Z":function(e,t){},HfaK:function(e,t){e.exports="data:image/png;base64,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"},K0bD:function(e,t){},M9W8:function(e,t){},MkWh:function(e,t){},NHnr:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=a("7+uW"),o=a("NYxO"),r={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"header-container"},[n("el-avatar",{attrs:{size:"60"}},[n("img",{attrs:{src:a("HfaK")}})]),e._v(" "),n("span",{staticStyle:{"margin-left":"10px"}},[e._v(e._s(this.$store.getters.user.userName))]),e._v(" "),n("a",{staticStyle:{"margin-left":"20px","margin-right":"10px",cursor:"pointer"},on:{click:function(t){return e.handleLogout()}}},[e._v("登出")])],1)},staticRenderFns:[]};var s={name:"App",components:{Header:a("VU/8")({name:"Header",methods:{handleLogout:function(){this.$store.dispatch("logout")}}},r,!1,function(e){a("RoON")},"data-v-39570df6",null).exports}},i={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("el-container",[t("el-header",{staticClass:"outer-container"},[this.$store.getters.isLoggedIn?t("Header"):this._e()],1),this._v(" "),t("el-main",{staticClass:"outer-container",attrs:{id:"el-main"}},[t("router-view")],1)],1)],1)},staticRenderFns:[]};var l=a("VU/8")(s,i,!1,function(e){a("K0bD")},null,null).exports,c=a("mtWM"),p=a.n(c),d=a("zL8q"),u=a.n(d),f=a("//Fk"),m=a.n(f),h=a("/ocq");var g={name:"Login",components:{},data:function(){return{form:{username:"",password:""},loading:!1}},methods:{login:function(){var e,t,a,n=this;e=this.form,t=e.username,a=e.password,(t?a||(d.Message.error({message:"密码不能为空"}),0):(d.Message.error({message:"用户名不能为空"}),0))&&this.$store.dispatch("login",this.form).then(function(e){n.$router.replace("/main")}).catch(function(e){n.$message({type:"error",message:""+e})})},handleLogin:function(){if(this.form.username)if(this.form.password){var e=this;this.loading=!0,p.a.post("/manager/login",{username:this.form.username,password:this.form.password}).then(function(t){if(t&&200==t.status){if(0!=t.data.retCode)throw new Error(t.data.retMsg);e.$store.commit("login",t.data.data),e.$router.replace("/main")}}).catch(function(t){e.errorMsg.userNameErrorMsg=t.message}).finally(function(){e.loading=!1})}else this.errorMsg.passwordErrorMsg="密码不能为空";else this.errorMsg.userNameErrorMsg="用户名不能为空"}}},v={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{model:e.form,id:"form-container"}},[a("el-form-item",{attrs:{prop:"username"}},[a("el-input",{attrs:{placeholder:"用户名"},model:{value:e.form.username,callback:function(t){e.$set(e.form,"username",t)},expression:"form.username"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"password"}},[a("el-input",{attrs:{type:"password",autocomplete:"off",placeholder:"密码"},model:{value:e.form.password,callback:function(t){e.$set(e.form,"password",t)},expression:"form.password"}})],1),e._v(" "),a("el-button",{staticStyle:{width:"100%"},attrs:{type:"primary"},on:{click:e.login}},[e._v("登录")])],1)},staticRenderFns:[]};var b=a("VU/8")(g,v,!1,function(e){a("6w8Z")},"data-v-68d818e5",null).exports,I={name:"AppCard",props:{app:Object},methods:{handleClicked:function(){this.$router.push({path:"/app-detail",query:{appId:this.app.appId}})}}},A={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-card",{staticClass:"box-card"},[a("div",{staticClass:"card",on:{click:function(t){return e.handleClicked()}}},[a("div",{staticStyle:{flex:"2",display:"flex","align-items":"center","justify-content":"flex-end"}},[e.app.appIcon?a("img",{attrs:{src:"manager/upload/ico/"+e.app.appIcon,width:"100",height:"100"}}):a("img",{attrs:{src:"manager/static/box.png",width:"100",height:"100"}})]),e._v(" "),a("div",{staticStyle:{flex:"2",display:"flex","flex-direction":"column","justify-content":"center","margin-left":"10px"}},[a("p",{staticClass:"name"},[e._v(e._s(e.app.appName))]),e._v(" "),e.app.lastVersion?a("p",{staticClass:"version"},[e._v(e._s(e.app.lastVersion))]):e._e(),e._v(" "),e.app.lastDistTime?a("p",{staticClass:"disttime"},[e._v(e._s(e.app.lastDistTime))]):e._e()])])])],1)},staticRenderFns:[]};var y={name:"Main",components:{AppCard:a("VU/8")(I,A,!1,function(e){a("2N0H")},"data-v-18239d40",null).exports},data:function(){return{form:{appName:"",appDesc:""},apps:[],pageLoading:!1,dialogFormVisible:!1}},methods:{getAppList:function(){var e=this;this.pageLoading=!0,p()({url:"/manager/listApp",data:{},method:"POST"}).then(function(t){e.apps=t}).finally(function(){e.pageLoading=!1})},handleAddApp:function(){var e,t,a,n=this;e=this.form,t=e.appName,a=e.appDesc,(t?a||(d.Message.error({message:"应用描述不能为空"}),0):(d.Message.error({message:"应用名称不能为空"}),0))&&p()({url:"/manager/createApp",data:this.form,method:"POST"}).then(this.getAppList).finally(function(){n.dialogFormVisible=!1,n.pageLoading=!0,n.form={appName:"",appDesc:""}})}},mounted:function(){this.getAppList()}},w={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{"element-loading-text":"应用列表加载中...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[a("el-row",[e._l(e.apps,function(e){return a("el-col",{key:e.index,attrs:{span:6}},[a("AppCard",{attrs:{app:e}})],1)}),e._v(" "),a("el-col",{attrs:{span:6}},[a("div",{on:{click:function(t){e.dialogFormVisible=!0}}},[a("el-card",{staticClass:"box-card"},[a("div",{staticStyle:{border:"3px #bbb dashed",width:"120px",height:"120px","text-align":"center"}},[a("span",{staticStyle:{"font-size":"80px",color:"#bbb","line-height":"120px"}},[e._v("+")])])])],1)])],2),e._v(" "),a("el-dialog",{attrs:{title:"添加应用",visible:e.dialogFormVisible,width:"50%"},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{model:e.form}},[a("el-form-item",{attrs:{prop:"appName"}},[a("el-input",{attrs:{placeholder:"应用名称"},model:{value:e.form.appName,callback:function(t){e.$set(e.form,"appName",t)},expression:"form.appName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"appDesc"}},[a("el-input",{attrs:{type:"textarea",rows:3,autocomplete:"off",placeholder:"应用描述",resize:"none"},model:{value:e.form.appDesc,callback:function(t){e.$set(e.form,"appDesc",t)},expression:"form.appDesc"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.pageLoading,expression:"pageLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{type:"primary","element-loading-text":"Loading...","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{click:function(t){return e.handleAddApp()}}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var k=a("VU/8")(y,w,!1,function(e){a("M9W8")},"data-v-a7254652",null).exports,C={name:"AppDetail",components:{},data:function(){return{form:{baseInfo:{appName:"",appDesc:"",appCreateTime:"",appIcon:""}},baseInfoLoading:!1,verListLoading:!1,verDetailDialogVisible:!1,verList:[],itemList:[],selectedVerName:""}},mounted:function(){this.fetchBaseInfo(),this.fetchVerInfo()},methods:{fetchBaseInfo:function(){var e=this;this.baseInfoLoading=!0,p()({url:"/manager/queryApp?appId="+this.$route.query.appId,method:"GET"}).then(function(t){e.form.baseInfo=t}).finally(function(){e.baseInfoLoading=!1})},fetchVerInfo:function(){var e=this;this.verListLoading=!0,p()({url:"/manager/listVer",data:{appId:this.$route.query.appId},method:"POST"}).then(function(t){e.verList=t}).finally(function(){e.verListLoading=!1})},handleEditAppInfo:function(){this.$router.push({path:"/edit-app",query:{appId:this.$route.query.appId}})},handleCreateVersion:function(){this.$router.push({path:"/create-version",query:{appId:this.$route.query.appId}})},handleDownloadPackage:function(e,t){var a=this;this.loading=!0;var n={headers:{"Content-Type":"application/json; application/octet-stream",token:this.$store.getters.token},responseType:"blob"};p.a.get("/manager/download?file="+t[e].pkgs[0].pkgName+"&type=zip",n).then(function(n){if(console.log(n),n){var o=window.URL.createObjectURL(new Blob([n])),r=document.createElement("a");r.href=o,r.setAttribute("download",a.form.baseInfo.appName+"-"+t[e].verName+".zip"),document.body.appendChild(r),r.click()}}).catch(function(e){a.$alert(""+e,"异常",{type:"error"})}).finally(function(){a.verListLoading=!1})}}},x={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-divider",{staticClass:"divider",attrs:{"content-position":"left"}},[a("h3",[e._v("基本信息")])]),e._v(" "),a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:5}},[a("div",{staticStyle:{height:"160px",display:"flex","justify-content":"center","align-items":"center"}},[e.form.baseInfo.appIcon?a("img",{attrs:{src:"manager/upload/ico/"+e.form.baseInfo.appIcon,width:"100",height:"100"}}):a("img",{staticClass:"avatar",attrs:{src:"/manager/static/box.png",width:"60",height:"60"}})])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:5}},[a("span",[e._v("应用ID")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("span",{staticStyle:{display:"block","text-align":"left"}},[e._v(e._s(e.form.baseInfo.appId))])])],1),e._v(" "),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:5}},[a("span",[e._v("应用名称")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("span",{staticStyle:{display:"block","text-align":"left"}},[e._v(e._s(e.form.baseInfo.appName))])])],1),e._v(" "),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:5}},[a("span",[e._v("创建时间")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("span",{staticStyle:{display:"block","text-align":"left"}},[e._v(e._s(e.form.baseInfo.appCreateTime))])])],1),e._v(" "),a("el-row",{staticClass:"row"},[a("el-col",{attrs:{span:5}},[a("span",[e._v("应用描述")])]),e._v(" "),a("el-col",{attrs:{span:19}},[a("span",{staticStyle:{display:"block","text-align":"left"}},[e._v(e._s(e.form.baseInfo.appDesc))])])],1),e._v(" "),a("el-row",{staticClass:"row"},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.handleEditAppInfo()}}},[e._v("编辑信息")])],1)],1)],1),e._v(" "),a("el-divider",{staticClass:"divider",attrs:{"content-position":"left"}},[a("h3",[e._v("版本列表")])]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.verListLoading,expression:"verListLoading"}],attrs:{data:e.verList}},[a("el-table-column",{attrs:{prop:"verName",label:"版本号","min-width":"15%"}}),e._v(" "),a("el-table-column",{attrs:{label:"变更项","min-width":"25%"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(e.verList[t.$index].items,function(t,n){return a("div",{key:n},[e._v("● "+e._s(t))])})}}])}),e._v(" "),a("el-table-column",{attrs:{label:"大小（byte）","min-width":"15%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",[e._v(e._s(e.verList[t.$index].pkgs[0].pkgSize))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"userName",label:"上传用户","min-width":"15%"}}),e._v(" "),a("el-table-column",{attrs:{prop:"verCreateTime",label:"创建时间","min-width":"20%"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作","min-width":"10%"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small"},on:{click:function(a){return e.handleDownloadPackage(t.$index,e.verList)}}},[e._v("下载")])]}}])})],1),e._v(" "),a("el-row",{staticClass:"row"},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.handleCreateVersion()}}},[e._v("发布新版")])],1),e._v(" "),a("el-dialog",{attrs:{title:e.selectedVerName+" 变更项",visible:e.verDetailDialogVisible},on:{"update:visible":function(t){e.verDetailDialogVisible=t}}},[a("el-table",{attrs:{data:e.itemList}},[a("el-table-column",{attrs:{type:"index"}}),e._v(" "),a("el-table-column",{attrs:{property:"itemDesc"}})],1)],1)],1)},staticRenderFns:[]};var L=a("VU/8")(C,x,!1,function(e){a("MkWh")},"data-v-f14834d8",null).exports,N={name:"EditAppInfo",components:{},data:function(){return{header:{token:this.$store.getters.token},form:{baseInfo:{appId:"",appName:"",appDesc:"",appCreateTime:"",appIcon:""}},baseInfoLoading:!1,imageUrl:""}},mounted:function(){this.fetchBaseInfo()},methods:{fetchBaseInfo:function(){var e=this;this.baseInfoLoading=!0,p()({url:"/manager/queryApp?appId="+this.$route.query.appId,method:"GET"}).then(function(t){e.form.baseInfo=t}).finally(function(){e.baseInfoLoading=!1})},handleIconUploadSuccess:function(e,t,a){this.fetchBaseInfo(),d.Message.success({message:"上传成功"})},handleIconUploadError:function(e,t,a){d.Message.error({message:"上传失败 "+e})},handleUpdateAppInfo:function(){var e=this;(this.form.baseInfo.appDesc||(d.Message.error({message:"应用描述不能为空"}),0))&&(this.baseInfoLoading=!0,p()({url:"/manager/modifyApp",data:{appId:this.$route.query.appId,appName:this.form.baseInfo.appName,appDesc:this.form.baseInfo.appDesc},method:"POST"}).then(function(t){d.Message.success({message:"修改成功"}),e.$router.back(-1)}).finally(function(){e.baseInfoLoading=!1}))}}},_={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("el-upload",{ref:"upload",staticClass:"avatar-uploader",attrs:{data:{appId:this.$route.query.appId},headers:e.header,"auto-upload":!0,action:"/manager/uploadAppIcon","show-file-list":!0,"on-success":e.handleIconUploadSuccess,"on-error":e.handleIconUploadError}},[e.form.baseInfo.appIcon?a("img",{staticClass:"avatar",attrs:{src:"/manager/upload/ico/"+e.form.baseInfo.appIcon}}):a("i",{staticClass:"el-icon-plus avatar-uploader-icon"})]),e._v(" "),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.baseInfoLoading,expression:"baseInfoLoading"}],attrs:{id:"form-container",model:e.form,"label-width":"120px"}},[a("el-form-item",{attrs:{prop:"appId",label:"应用ID"}},[a("el-input",{attrs:{placeholder:"应用ID",disabled:!0},model:{value:e.form.baseInfo.appId,callback:function(t){e.$set(e.form.baseInfo,"appId",t)},expression:"form.baseInfo.appId"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"appName",label:"应用名称"}},[a("el-input",{attrs:{placeholder:"应用名称"},model:{value:e.form.baseInfo.appName,callback:function(t){e.$set(e.form.baseInfo,"appName",t)},expression:"form.baseInfo.appName"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"appDesc",label:"应用描述"}},[a("el-input",{attrs:{type:"textarea",rows:3,autocomplete:"off",resize:"none"},model:{value:e.form.baseInfo.appDesc,callback:function(t){e.$set(e.form.baseInfo,"appDesc",t)},expression:"form.baseInfo.appDesc"}})],1),e._v(" "),a("el-form-item",{attrs:{prop:"appCreateTime",label:"创建时间"}},[a("el-input",{attrs:{placeholder:"创建时间",disabled:!0},model:{value:e.form.baseInfo.appCreateTime,callback:function(t){e.$set(e.form.baseInfo,"appCreateTime",t)},expression:"form.baseInfo.appCreateTime"}})],1)],1),e._v(" "),a("el-row",{staticClass:"row"},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.handleUpdateAppInfo()}}},[e._v("提交修改")])],1)],1)},staticRenderFns:[]};var V=a("VU/8")(N,_,!1,function(e){a("2RMo")},"data-v-113e8511",null).exports,D={name:"CreateVersion",components:{},data:function(){return{header:{token:this.$store.getters.token},form:{verInfo:{verName:""},items:[{itemDesc:""}],fileInfo:{fileName:"",fileSize:""}},loading:!1}},methods:{buttonEnabled:function(){return function(e){if(!e.verInfo.verName)return!1;if(0==e.items.length)return!1;if(!e.fileInfo.fileName)return!1;for(var t=0;t<e.items.length;t++)if(""===e.items[t].itemDesc.trim())return!1;return!0}(this.form)},handleUploadZipSuccess:function(e,t,a){this.form.fileInfo=e.data,d.Message.success({message:"上传成功"})},handleUploadZipError:function(e,t,a){d.Message.error({message:"上传失败 "+e})},handleAddUpdateItem:function(){this.form.items.push({itemDesc:""})},handleDeleteItem:function(e){var t=this;this.$confirm("是否要删除此变更项?","提示",{confirmButtonText:"删除",cancelButtonText:"取消",type:"warning"}).then(function(){t.form.items.splice(e,1)})},handleUploadZipBefore:function(e){return!0},handleUpload:function(){this.$refs.upload.submit()},handleDistribute:function(){var e=this;this.loading=!0;var t=this.form,a=t.fileInfo,n=t.verInfo,o=t.items,r=a.fileName,s=a.fileSize,i=n.verName;p()({url:"/manager/commitVer",data:{ver:{appId:this.$route.query.appId,verName:i},items:o,pkg:{pkgName:r,pkgSize:s}},method:"POST"}).then(function(t){d.Message.success({message:"提交成功"}),e.$router.back(-1)}).finally(function(){e.loading=!0})}}},M={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("el-divider",{staticClass:"divider",attrs:{"content-position":"left"}},[a("h3",[e._v("基本信息")])]),e._v(" "),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{id:"form-container",model:e.form,"label-width":"80px"}},[a("el-form-item",{attrs:{prop:"verName",label:"版本号"}},[a("el-input",{attrs:{placeholder:"版本号"},model:{value:e.form.verInfo.verName,callback:function(t){e.$set(e.form.verInfo,"verName",t)},expression:"form.verInfo.verName"}})],1),e._v(" "),a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("el-divider",{staticClass:"divider",attrs:{"content-position":"left"}},[a("h3",[e._v("变更项")])]),e._v(" "),e._l(e.form.items,function(t,n){return a("el-row",{key:n,staticClass:"row"},[a("el-form-item",{attrs:{prop:"itemDesc",label:"变更项 "+(n+1)}},[a("el-col",{attrs:{span:23}},[a("el-input",{attrs:{placeholder:"变更项 "+(n+1)},model:{value:e.form.items[n].itemDesc,callback:function(t){e.$set(e.form.items[n],"itemDesc",t)},expression:"form.items[index].itemDesc"}})],1),e._v(" "),a("el-col",{staticStyle:{"text-align":"center"},attrs:{span:1}},[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(t){return e.handleDeleteItem(n)}}})],1)],1)],1)}),e._v(" "),a("el-row",{staticClass:"row"},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary"},on:{click:function(t){return e.handleAddUpdateItem()}}},[e._v("新增变更项")])],1),e._v(" "),a("div",{staticStyle:{height:"20px"}}),e._v(" "),a("el-divider",{staticClass:"divider",attrs:{"content-position":"left"}},[a("h3",[e._v("应用包")])]),e._v(" "),a("el-upload",{ref:"upload",staticClass:"upload-demo",staticStyle:{"text-align":"center"},attrs:{drag:"",headers:e.header,action:"/manager/upload",accept:".zip","auto-upload":!0,"show-file-list":!1,multiple:!1,"before-upload":e.handleUploadZipBefore,"on-success":e.handleUploadZipSuccess,"on-error":e.handleUploadZipError}},[a("i",{staticClass:"el-icon-upload"}),e._v(" "),a("div",{staticClass:"el-upload__text"},[e._v("点选或拖入后将自动上传")])])],2),e._v(" "),a("el-row",{staticClass:"row"},[a("el-button",{staticStyle:{float:"right"},attrs:{type:"primary",disabled:!this.buttonEnabled()},on:{click:function(t){return e.handleDistribute()}}},[e._v("立即发布")])],1)],1)},staticRenderFns:[]};var O=a("VU/8")(D,M,!1,function(e){a("57qT")},"data-v-ceded4a8",null).exports;n.default.use(h.a);var S=new h.a({routes:[{path:"/login",name:"Login",component:b},{path:"/main",name:"Main",component:k,meta:{requiresAuth:!0}},{path:"/app-detail",name:"AppDetail",component:L,meta:{requiresAuth:!0}},{path:"/edit-app",name:"EditAppInfo",component:V,meta:{requiresAuth:!0}},{path:"/create-version",name:"CreateVersion",component:O,meta:{requiresAuth:!0}}]});S.beforeEach(function(e,t,a){if(e.matched.some(function(e){return e.meta.requiresAuth})){if(F.getters.isLoggedIn)return void a();a("/login")}else a()});var Z=S;n.default.use(o.a);var F=new o.a.Store({state:{status:"",token:localStorage.getItem("token")||"",user:{}},mutations:{auth_request:function(e){e.status="loading"},auth_success:function(e,t){var a=t.token,n=t.user;console.log("user",{token:a,user:n}),e.status="success",e.token=a,e.user=n},auth_error:function(e){e.status="error"},logout:function(e){e.status="",e.token=""}},actions:{login:function(e,t){return new m.a(function(a,n){e.commit("auth_request"),p()({url:"/manager/login",data:t,method:"POST"}).then(function(t){console.log("/manager/login >>>>> ",t);var n=t.userToken;delete t.userToken,localStorage.setItem("token",n),p.a.defaults.headers.common.token=n,e.commit("auth_success",{token:n,user:t}),a(t)}).catch(function(t){e.commit("auth_error"),localStorage.removeItem("token"),n(t)})})},logout:function(e){return new m.a(function(t,a){e.commit("auth_request"),p()({url:"/manager/logout",data:{},method:"POST"}).then(function(){e.commit("logout"),localStorage.removeItem("token"),delete p.a.defaults.headers.common.token,Z.replace("/login"),t()}).catch(function(t){e.commit("auth_error"),localStorage.removeItem("token"),a(t)})})}},getters:{user:function(e){return e.user},isLoggedIn:function(e){return!!e.token},authStatus:function(e){return e.status},token:function(e){return e.token}}});p.a.interceptors.response.use(function(e){console.log("axios 拦截响应",e);var t=e.data;if("blob"===e.request.responseType){if("application/json"!==e.headers["content-type"])return t;var a=new FileReader;a.readAsText(t,"UTF-8"),a.onload=function(){d.Message.error({message:JSON.parse(this.result).retMsg})}}if(1!==t.retCode)return t.data;d.Message.error({message:t.retMsg})},function(e){403===e.response.status?(d.Message.error({message:"尚未登录，请登录"}),F.dispatch("logout")):d.Message.error({message:"错误码 "+e.response.status})});a("tvR6");n.default.use(o.a),n.default.use(u.a),n.default.prototype.$alert=d.MessageBox.alert,n.default.prototype.$confirm=d.MessageBox.confirm,n.default.config.productionTip=!1,new n.default({el:"#app",router:Z,store:F,components:{App:l},template:"<App/>"})},RoON:function(e,t){},tvR6:function(e,t){}},["NHnr"]);